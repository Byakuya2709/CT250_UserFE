import{_ as f,r as b,c as o,o as r,a as n,d as y,h as x,F as h,f as p,t as c,e as _,A as v,g as u}from"./index-ocYKao6t.js";import{L as k}from"./index-BS5tuat5.js";import{f as I}from"./format-DkMBOXoR.js";const P={components:{Loading:k},data(){return{feedbacks:[],loading:!1,error:null,page:1,size:10,totalPages:1,userId:""}},methods:{goToEventDetails(e){this.$router.push({path:`/events/${e}`})},async deleteFeedback(e){var t,l;this.loading=!0;try{this.loading=!0,await u.delete(`/blogs/feedback/${e.fbId}`),this.feedbacks=this.feedbacks.filter(i=>i.fbId!==e.fbId);const d={eventId:e.eventId,userId:e.fbUserId,star:e.fbRate};console.log(d);const a=await u.patch(`/tickets/feedback/${e.ticketId}`,d);this.$toast.success(a.data.message)}catch(d){console.log(d),this.$toast.error(((l=(t=d.response)==null?void 0:t.data)==null?void 0:l.message)||"Đã xảy ra lỗi")}finally{this.loading=!1}},async fetchFeedbacks(){var e,t;this.loading=!0,this.error=null;try{const l=await u.get(`/blogs/feedbacks/user/${this.$route.params.userId}?page=${this.page-1}&size=${this.size}`);this.feedbacks=l.data.data.content,this.totalPages=l.data.data.totalPages}catch(l){this.error=((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch feedbacks",this.$toast.error(this.error)}finally{this.loading=!1}},formatDate(e){return e?I(new Date(e),"dd/MM/yyyy HH:mm"):"Chưa xác định"},prevPage(){this.page>1&&(this.page--,this.fetchFeedbacks())},nextPage(){this.page<this.totalPages&&(this.page++,this.fetchFeedbacks())}},mounted(){this.userId=this.$route.params.userId,this.fetchFeedbacks()}},w={class:"p-6 bg-white shadow-lg rounded-lg"},C={key:0,class:"text-center text-gray-500"},F={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},D=["onClick"],T={class:"text-xl font-semibold text-gray-800 mb-2"},B={class:"flex items-center mb-2"},N={class:"text-gray-700"},R={class:"text-gray-600 text-sm mt-2"},V={class:"font-semibold"},z=["onClick"],E={key:2,class:"flex justify-between items-center mt-6"},L=["disabled"],M={class:"text-gray-800 font-medium"},H=["disabled"];function $(e,t,l,d,a,i){const m=b("loading");return r(),o("div",w,[t[3]||(t[3]=n("h2",{class:"text-3xl font-bold text-gray-800 mb-6 text-center"}," Đánh Giá Của Bạn ",-1)),y(m,{active:a.loading},null,8,["active"]),a.feedbacks.length===0&&!a.loading?(r(),o("div",C," Bạn chưa có đánh giá nào. ")):(r(),o("div",F,[(r(!0),o(h,null,p(a.feedbacks,s=>(r(),o("div",{onClick:g=>i.goToEventDetails(s.eventId),key:s.fbId,class:"p-6 border rounded-lg shadow-md bg-gray-50"},[n("h3",T," Đánh giá từ sự kiện/vé: "+c(s.eventId)+" / "+c(s.ticketId),1),n("div",B,[(r(!0),o(h,null,p(s.fbRate,g=>(r(),o("span",{class:"text-yellow-500 mr-1",key:g},"⭐"))),128)),(r(!0),o(h,null,p(5-s.fbRate,g=>(r(),o("span",{class:"text-gray-500",key:`empty-${g}`},"☆"))),128))]),n("p",N,c(s.fbContent),1),n("p",R,[t[2]||(t[2]=_(" Ngày đánh giá: ")),n("span",V,c(i.formatDate(s.fbCreateDate)),1)]),n("button",{onClick:v(g=>i.deleteFeedback(s),["stop"]),class:"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg"}," Xóa ",8,z)],8,D))),128))])),a.totalPages>1?(r(),o("div",E,[n("button",{onClick:t[0]||(t[0]=(...s)=>i.prevPage&&i.prevPage(...s)),disabled:a.page===1,class:"px-4 py-2 bg-blue-500 text-gray-700 rounded-lg disabled:opacity-50"}," Trang trước ",8,L),n("span",M,"Trang "+c(a.page)+" / "+c(a.totalPages),1),n("button",{onClick:t[1]||(t[1]=(...s)=>i.nextPage&&i.nextPage(...s)),disabled:a.page===a.totalPages,class:"px-4 py-2 bg-blue-500 text-gray-700 rounded-lg"}," Trang sau ",8,H)])):x("",!0)])}const U=f(P,[["render",$]]);export{U as default};
