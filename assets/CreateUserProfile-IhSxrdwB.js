import{_ as B,c as t,o,a,i as u,h as l,E as h,n as m,t as d,v,F as N,f,A as y,g as p}from"./index-ocYKao6t.js";const F=[{code:"01",name:"Hà Nội"},{code:"02",name:"Hồ Chí Minh"},{code:"03",name:"Đà Nẵng"},{code:"04",name:"Hải Phòng"},{code:"05",name:"Cần Thơ"},{code:"06",name:"Hải Dương"},{code:"08",name:"Bắc Ninh"},{code:"10",name:"Quảng Ninh"},{code:"11",name:"Lạng Sơn"},{code:"12",name:"Bắc Giang"},{code:"13",name:"Vĩnh Phúc"},{code:"14",name:"Bình Dương"},{code:"15",name:"Bình Phước"},{code:"17",name:"Hưng Yên"},{code:"19",name:"Thái Nguyên"},{code:"20",name:"Thanh Hóa"},{code:"21",name:"Nghệ An"},{code:"22",name:"Hà Tĩnh"},{code:"23",name:"Quảng Bình"},{code:"24",name:"Quảng Trị"},{code:"25",name:"Thừa Thiên Huế"},{code:"26",name:"Quảng Nam"},{code:"27",name:"Quảng Ngãi"},{code:"28",name:"Bình Định"},{code:"29",name:"Phú Yên"},{code:"30",name:"Khánh Hòa"},{code:"31",name:"Ninh Thuận"},{code:"32",name:"Bình Thuận"},{code:"33",name:"Kon Tum"},{code:"34",name:"Gia Lai"},{code:"35",name:"Đắk Lắk"},{code:"36",name:"Đắk Nông"},{code:"37",name:"Lâm Đồng"},{code:"38",name:"Bình Phước"},{code:"39",name:"Tây Ninh"},{code:"40",name:"Vĩnh Long"},{code:"41",name:"Trà Vinh"},{code:"42",name:"Bạc Liêu"},{code:"43",name:"Cà Mau"},{code:"44",name:"Long An"},{code:"45",name:"Đồng Nai"},{code:"46",name:"Tiền Giang"},{code:"47",name:"Hậu Giang"},{code:"48",name:"Sóc Trăng"},{code:"49",name:"An Giang"},{code:"50",name:"Kiên Giang"},{code:"51",name:"Cần Thơ"},{code:"52",name:"Bến Tre"},{code:"53",name:"Đồng Tháp"},{code:"54",name:"Tây Ninh"},{code:"55",name:"Bình Dương"},{code:"56",name:"Hà Nam"},{code:"57",name:"Nam Định"},{code:"58",name:"Ninh Bình"},{code:"59",name:"Thái Bình"},{code:"60",name:"Lạng Sơn"},{code:"61",name:"Vĩnh Phúc"},{code:"62",name:"Lai Châu"},{code:"63",name:"Điện Biên"}],T={data(){return{user:{userName:"",userMail:sessionStorage.getItem("UserEmail"),userPhone:"",userGender:"MALE",userAddress:"",userBirth:"",imageURL:null},avatarFile:null,previewImage:null,errors:{userName:"",userPhone:"",userGender:"",userAddress:"",userBirth:"",avatarFile:""},provinces:F}},methods:{handleFileChange(s){const e=s.target.files[0],g=["image/jpeg","image/png","image/gif"],c=5*1024*1024;if(e)if(!g.includes(e.type))this.errors.avatarFile="Chỉ hỗ trợ các tệp hình ảnh (JPEG, PNG, GIF).",this.avatarFile=null,this.previewImage=null;else if(e.size>c)this.errors.avatarFile="Kích thước tệp không được vượt quá 5MB.",this.avatarFile=null,this.previewImage=null;else{this.errors.avatarFile="",this.avatarFile=e;const r=new FileReader;r.onload=i=>{this.previewImage=i.target.result},r.readAsDataURL(e)}},validateField(s){s==="userName"&&!this.user.userName.trim()?this.errors.userName="Họ tên không được để trống.":s==="userPhone"&&!/^\d{10}$/.test(this.user.userPhone)?this.errors.userPhone="Số điện thoại không hợp lệ (phải gồm 10 chữ số).":s==="userGender"&&!this.user.userGender?this.errors.userGender="Vui lòng chọn giới tính.":s==="userAddress"&&!this.user.userAddress.trim()?this.errors.userAddress="Địa chỉ không được để trống.":s==="userBirth"&&!this.user.userBirth?this.errors.userBirth="Vui lòng chọn ngày sinh.":s==="userBirth"&&this.isUnder14YearsOld()?this.errors.userBirth="Bạn phải từ 14 tuổi trở lên.":this.errors[s]=""},isUnder14YearsOld(){const s=new Date(this.user.userBirth);return new Date().getFullYear()-s.getFullYear()<14},async submitForm(){for(const s in this.user)s!=="avatarUrl"&&s!=="userMail"&&this.validateField(s);if(Object.values(this.errors).some(s=>s)){this.$toast.error("Vui lòng kiểm tra lại các trường nhập liệu.");return}try{const s=await this.uploadAvatar();s.data.data.imageUrl&&(this.user.imageURL=s.data.data.imageUrl,await this.createUser())}catch{this.$toast.error("Đã xảy ra lỗi khi tải lên Avatar hoặc tạo người dùng.")}},async uploadAvatar(){const s=new FormData;return s.append("file",this.avatarFile),await p.post("/media/upload",s,{params:{accountId:this.$route.query.accountId},headers:{"Content-Type":"multipart/form-data"}})},async createUser(){try{const s=this.$route.query.accountId;console.log(this.user.avatarUrl);const e=await p.post("/users",this.user,{params:{accountId:s}});this.$toast.success(e.data.message)}catch(s){console.log(s),this.$toast.error("Đã xảy ra lỗi khi tạo người dùng")}}}},A={class:"avatar-container"},P={key:0,class:"preview"},G=["src"],w={key:0,class:"error"},k={key:1,class:"error"},U={key:2,class:"error"},b=["value"],C={key:3,class:"error"},L={key:4,class:"error"};function M(s,e,g,c,r,i){return o(),t("div",null,[a("form",{onSubmit:e[12]||(e[12]=y((...n)=>i.submitForm&&i.submitForm(...n),["prevent"]))},[a("div",A,[e[13]||(e[13]=a("label",{for:"avatar"},"Chọn Avatar:",-1)),a("input",{type:"file",id:"avatar",onChange:e[0]||(e[0]=(...n)=>i.handleFileChange&&i.handleFileChange(...n))},null,32),r.previewImage?(o(),t("div",P,[a("img",{src:r.previewImage,alt:"Preview Avatar",class:"avatar-preview"},null,8,G)])):l("",!0)]),e[15]||(e[15]=a("label",{for:"userName"},"Họ Tên:",-1)),u(a("input",{type:"text",id:"userName","onUpdate:modelValue":e[1]||(e[1]=n=>r.user.userName=n),class:m({invalid:r.errors.userName}),onBlur:e[2]||(e[2]=n=>i.validateField("userName"))},null,34),[[h,r.user.userName]]),r.errors.userName?(o(),t("span",w,d(r.errors.userName),1)):l("",!0),e[16]||(e[16]=a("label",{for:"userMail"},"Email:",-1)),u(a("input",{type:"email",id:"userMail","onUpdate:modelValue":e[3]||(e[3]=n=>r.user.userMail=n),readonly:"",disabled:""},null,512),[[h,r.user.userMail]]),e[17]||(e[17]=a("label",{for:"userPhone"},"Số Điện Thoại:",-1)),u(a("input",{type:"text",id:"userPhone","onUpdate:modelValue":e[4]||(e[4]=n=>r.user.userPhone=n),class:m({invalid:r.errors.userPhone}),onBlur:e[5]||(e[5]=n=>i.validateField("userPhone"))},null,34),[[h,r.user.userPhone]]),r.errors.userPhone?(o(),t("span",k,d(r.errors.userPhone),1)):l("",!0),e[18]||(e[18]=a("label",{for:"userGender"},"Giới Tính:",-1)),u(a("select",{"onUpdate:modelValue":e[6]||(e[6]=n=>r.user.userGender=n),class:m({invalid:r.errors.userGender}),onBlur:e[7]||(e[7]=n=>i.validateField("userGender"))},e[14]||(e[14]=[a("option",{value:"MALE"},"Nam",-1),a("option",{value:"FEMALE"},"Nữ",-1)]),34),[[v,r.user.userGender]]),r.errors.userGender?(o(),t("span",U,d(r.errors.userGender),1)):l("",!0),e[19]||(e[19]=a("label",{for:"userAddress"},"Địa Chỉ:",-1)),u(a("select",{"onUpdate:modelValue":e[8]||(e[8]=n=>r.user.userAddress=n),class:m({invalid:r.errors.userAddress}),onBlur:e[9]||(e[9]=n=>i.validateField("userAddress"))},[(o(!0),t(N,null,f(r.provinces,n=>(o(),t("option",{key:n.code,value:n.name},d(n.name),9,b))),128))],34),[[v,r.user.userAddress]]),r.errors.userAddress?(o(),t("span",C,d(r.errors.userAddress),1)):l("",!0),e[20]||(e[20]=a("label",{for:"userBirth"},"Ngày Sinh:",-1)),u(a("input",{type:"date",id:"userBirth","onUpdate:modelValue":e[10]||(e[10]=n=>r.user.userBirth=n),class:m({invalid:r.errors.userBirth}),onBlur:e[11]||(e[11]=n=>i.validateField("userBirth"))},null,34),[[h,r.user.userBirth]]),r.errors.userBirth?(o(),t("span",L,d(r.errors.userBirth),1)):l("",!0),e[21]||(e[21]=a("button",{type:"submit"},"Tạo Người Dùng",-1))],32)])}const H=B(T,[["render",M],["__scopeId","data-v-c21638c4"]]);export{H as default};
